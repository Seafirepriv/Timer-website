<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Auto Countdown Timer üéâ</title>
  <style>
    /* ‚Äî‚Äî‚Äî Layout & base ‚Äî‚Äî‚Äî */
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: Arial, sans-serif;
      transition: background 0.3s, color 0.3s;
    }
    h1 { margin: 0 0 12px; }
    #timer {
      font-size: 3rem;
      font-weight: bold;
      margin: 20px 0;
    }

    /* ‚Äî‚Äî‚Äî Controls (bottom-left) ‚Äî‚Äî‚Äî */
    #controls {
      position: fixed;
      left: 14px;
      bottom: 14px;
      display: flex;
      gap: 8px;
    }
    .btn {
      font: inherit;               /* match other text */
      color: inherit;              /* match current theme color */
      padding: 6px 10px;
      border: 1px solid currentColor;
      background: transparent;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn:active { transform: translateY(1px); }

    /* ‚Äî‚Äî‚Äî Themes ‚Äî‚Äî‚Äî */
    body.light { background: #ffffff; color: #000000; }
    body.dark  { background: #121212; color: #f4f4f9; }

    /* Ensure timer text flips with theme */
    body.light #timer { color: #000000; }
    body.dark  #timer { color: #f4f4f9; }
  </style>
</head>
<body>
  <h1>‚è≥ Countdown Timer</h1>
  <div id="timer">0</div>

  <!-- Controls anchored bottom-left -->
  <div id="controls" aria-label="Page controls">
    <button id="themeToggle" class="btn">Toggle Light/Dark</button>
    <button id="confettiTest" class="btn">Test Confetti</button>
  </div>

  <!-- Confetti library -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

  <script>
    // ===================== THEME HELPERS =====================
    function applyTheme(theme) {
      document.body.classList.remove('light', 'dark');
      document.body.classList.add(theme);
    }
    function initTheme() {
      const saved = localStorage.getItem('theme');
      applyTheme(saved === 'dark' ? 'dark' : 'light'); // default: light
      const btn = document.getElementById('themeToggle');
      if (btn && !btn.dataset.bound) {
        btn.addEventListener('click', () => {
          const current = document.body.classList.contains('dark') ? 'dark' : 'light';
          const next = current === 'dark' ? 'light' : 'dark';
          applyTheme(next);
          localStorage.setItem('theme', next);
        });
        btn.dataset.bound = '1';
      }
    }
    // =========================================================

    // ====== Countdown target: Sep 4, 2025 10:00 AM ET (-04:00) ======
    const TARGET = new Date('2025-09-04T10:00:00-04:00');

    let ticking = null;
    let confettiFired = false;

    function pad(n) { return n.toString().padStart(2, '0'); }

    function fmt(ms) {
      const totalSeconds = Math.max(0, Math.floor(ms / 1000));
      const days = Math.floor(totalSeconds / 86400);
      const hours = Math.floor((totalSeconds % 86400) / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;
      return days > 0
        ? `${days}d ${pad(hours)}:${pad(minutes)}:${pad(seconds)}`
        : `${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;
    }

    // Shared confetti burst
    function launchConfetti() {
      confetti({ particleCount: 80, angle: 60,  spread: 55, origin: { x: 0 } });
      confetti({ particleCount: 80, angle: 120, spread: 55, origin: { x: 1 } });
    }

    // Bind test button without touching the countdown
    function initConfettiTest() {
      const testBtn = document.getElementById('confettiTest');
      if (testBtn && !testBtn.dataset.bound) {
        testBtn.addEventListener('click', launchConfetti);
        testBtn.dataset.bound = '1';
      }
    }

    function update() {
      const now = new Date();
      const remaining = TARGET - now;
      const el = document.getElementById('timer');

      if (remaining <= 0) {
        clearInterval(ticking);
        el.textContent = "üéâ Time's up!";
        if (!confettiFired) {
          confettiFired = true;
          launchConfetti();
        }
        return;
      }
      el.textContent = fmt(remaining);
    }

    // ‚Äî‚Äî‚Äî Init on load ‚Äî‚Äî‚Äî
    window.onload = () => {
      initTheme();
      initConfettiTest();
      update();
      clearInterval(ticking);
      ticking = setInterval(update, 1000);
    };
  </script>
</body>
</html>
